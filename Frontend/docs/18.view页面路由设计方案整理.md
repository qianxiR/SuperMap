# 路由设计方案整理

## 🎯 路由结构优化总结

### 主要修改内容

1. **修复了 home 路由自动跳转问题**
   - 移除了 `view/home` 的默认子路由重定向到 `layermanage`
   - 现在访问 `/dashboard/view/home` 会直接显示城市总览页面，不会自动跳转

2. **重新组织了子页面路由结构**
   - 将原来的 `subpage1`、`subpage2`、`subpage3` 改为语义化的路由名称
   - 统一了所有组件的导航配置

3. **更新了路由映射关系**

## 📋 当前路由结构

### 视图页面路由层级

```
/dashboard/view/home (城市总览)
├── /dashboard/view/home/layermanage (图层管理)
├── /dashboard/view/home/traffic (水陆交通)
├── /dashboard/view/home/livelihood (民生资源)
└── /dashboard/view/home/water-monitoring (长江流域监测预警)
```

### 路由配置详情

| 路由路径 | 路由名称 | 组件文件 | 功能描述 | 页面标题 |
|---------|---------|----------|----------|----------|
| `/dashboard/view/home` | `view-home` | `ViewHome.vue` | 城市总览主页面 | 城市总览 |
| `/dashboard/view/home/layermanage` | `view-layer-manage` | `ViewLayerManager.vue` | 图层管理面板 | 图层管理 |
| `/dashboard/view/home/traffic` | `view-traffic` | `ViewSubPage1.vue` | 水陆交通分析 | 水陆交通 |
| `/dashboard/view/home/livelihood` | `view-livelihood` | `ViewSubPage2.vue` | 民生资源分析 | 民生资源 |
| `/dashboard/view/home/water-monitoring` | `view-water-monitoring` | `ViewSubPage3.vue` | 长江流域监测预警分析 | 长江流域监测预警 |

## 🔧 组件配置统一

### 导航按钮配置

所有子页面组件现在使用统一的按钮配置：

```javascript
const subPageButtons = [
  { id: 'home', text: '城市总览' },
  { id: 'livelihood', text: '民生资源' },
  { id: 'traffic', text: '水陆交通' },
  { id: 'water-monitoring', text: '长江流域监测预警' }
]
```

### 导航逻辑统一

所有组件使用统一的导航函数：

```javascript
const navigateToSubPage = async (subPageName: string) => {
  activeSubPage.value = subPageName
  if (subPageName === 'home') {
    // 跳转到城市总览页面
    await router.push('/dashboard/view/home')
  } else {
    // 跳转到对应的子页面
    router.push(`/dashboard/view/home/${subPageName}`)
  }
}
```

### 路由监听统一

所有组件使用统一的路由监听逻辑：

```javascript
watch(() => route.path, (newPath) => {
  if (newPath === '/dashboard/view' || newPath === '/dashboard/view/home' || newPath.endsWith('/dashboard/view/home/')) {
    activeSubPage.value = 'home'
  } else if (newPath.includes('/traffic')) {
    activeSubPage.value = 'traffic'
  } else if (newPath.includes('/livelihood')) {
    activeSubPage.value = 'livelihood'
  } else if (newPath.includes('/water-monitoring')) {
    activeSubPage.value = 'water-monitoring'
  }
}, { immediate: true })
```

## 🎨 页面功能对应

### 城市总览 (ViewHome.vue)
- **路由**: `/dashboard/view/home`
- **功能**: 显示城市整体概况，包含所有基础地图控件
- **特色组件**: 区域面积分布图表、距离量算、面积量算

### 水陆交通 (ViewSubPage1.vue)
- **路由**: `/dashboard/view/home/traffic`
- **功能**: 交通相关数据分析
- **特色组件**: 交通图例、公路等级统计图表、铁路类型统计图表

### 民生资源 (ViewSubPage2.vue)
- **路由**: `/dashboard/view/home/livelihood`
- **功能**: 民生相关数据分析
- **特色组件**: 区域人口数量图表、教育程度分布图表、男女比重分布图表、年龄人口分布图表

### 长江流域监测预警 (ViewSubPage3.vue)
- **路由**: `/dashboard/view/home/water-monitoring`
- **功能**: 长江流域监测预警数据分析
- **特色组件**: 水资源图例、水系面分类统计图表、水系线分类统计图表

### 图层管理 (ViewLayerManager.vue)
- **路由**: `/dashboard/view/home/layermanage`
- **功能**: 地图图层管理面板
- **特色功能**: 图层分组管理、可见性控制、图层导出

## 🚀 优化效果

1. **解决了自动跳转问题**: 访问城市总览页面不再自动跳转到图层管理
2. **统一了路由命名**: 使用语义化的路由名称，提高可维护性
3. **统一了组件配置**: 所有子页面使用相同的导航配置和逻辑
4. **改善了用户体验**: 页面切换更加流畅，导航状态同步准确

## 📝 使用说明

- 访问 `/dashboard/view/home` 直接进入城市总览页面
- 通过页面顶部的导航按钮可以在不同功能页面间切换
- 每个页面都有独立的功能组件和数据分析图表
- 图层管理作为独立功能，可通过导航按钮访问

这种设计既保持了功能的独立性，又确保了导航的一致性和用户体验的流畅性。
